program test;
{$hints off}
{$define SMART}
{.$define OW:SMARTDEBUG}
{.$define OW:DEBUG_WORDY}
{$I SRL/OSR.simba}
{$I ObjectWalk/Walker.simba}

const
  DEBUG_POINTS = False;

var
  Walker: TObjectWalk;
  colors:TIntegerArray;
  path:TMMPath;
  DTM:TMMDTM;

procedure Init();
begin
  srl.Debugging := False;
  Smart.EnableDrawing := True;
  Smart.JavaPath := 'D:\Java7-32\bin\javaw.exe';
  Smart.Init();
end;

procedure LoadMinePath();
begin
  SetLength(path, 5);
  Path[0].Features := [[mmRock,623,80],[mmTree,688,57],[mmTree,679,93]];
  Path[0].Points   := [[705,75]];
  Path[1].Features := [[mmDeadTree,623,44],[mmTree,616,100],[mmRock,597,84]];
  Path[1].Points   := [[703,76]];
  Path[2].Features := [[mmPalmTree,658,42],[mmTree,595,101],[mmRed,640,93]];
  Path[2].Points   := [[705,90]];
  Path[3].Features := [[mmPalmTree,674,48],[mmPalmTree,671,69],[mmPalmTree,688,63]];
  Path[3].Points   := [[682,118]];
  Path[4].Features := [[mmPalmTree,631,20],[mmPalmTree,630,40],[mmPalmTree,646,33]];
  Path[4].Points   := [[673,92]];
end;

procedure LoadFallyPath();
begin
  SetLength(Path, 5);
  path[0].Features := [[mmTree, 585, 68],[mmRed, 655, 122],[mmRed, 634, 129]];
  path[0].Points   := [[620,86], [616, 133]];
  path[1].Features := [[mmLadder, 661, 102],[mmLadder, 589, 92],[mmRed, 666, 118]];
  path[1].Points   := [[642,137]];
  path[2].Features := [[mmRed, 665, 65],[mmTree, 661, 118],[mmLadder, 659, 49]];
  path[2].Points   := [[620,133]];
  path[3].Features := [[mmPalmTree, 688, 115],[mmTree, 651,91],[mmTree, 638,132]];
  path[3].Points   := [[620,133]];
  path[4].Features := [[mmTree, 623, 82],[mmRock, 658, 128],[mmTree, 611, 112]];
  path[4].Points   := [[612, 128], [597, 142]];
end;

var
  d:Double;
  t:TDateTime;
begin
  Init();

  //Go into fally bank (the one close to guild mine)
  if not DEBUG_POINTS then
  begin
    Walker.Init();
    LoadFallyPath();
    WriteLn( Walker.Walk(path) );
  end else
  begin

    while True do
    begin
      Walker.DebugMinimap(smart.Image);
      Smart.Image.DrawTPA(TPAFromCircle(642,84, 63), 1118740);
    end;

  end;
end.
